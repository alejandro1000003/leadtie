const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/error-page-DpAlqp0P.js","assets/app-BSMtCD-y.js","assets/app-CybiHsuM.css"])))=>i.map(i=>d[i]);
import{r as m,j as e,c as j,R as v,J as k,f as E,_ as D}from"./app-BSMtCD-y.js";import{F as c,f as g,a as P,b as T,c as $,d as A}from"./index.es-C40HS0Ql.js";import{c as F,a as b}from"./client-api-service-BII4QMvG.js";/* empty css            */const R=()=>{const[t,a]=m.useState(!1),[r,o]=m.useState(!1);return e.jsxs("div",{className:"fixed top-15 right-5 mb-5 p-1",children:[e.jsx("button",{className:"ml-1 h-6 w-6 rounded bg-gray-800 font-bold text-white transition",onClick:()=>{o(s=>(s||a(!1),!s))},children:r?e.jsx(c,{icon:g}):e.jsx(c,{icon:P})}),e.jsx("button",{className:"ml-1 h-6 w-6 rounded bg-gray-800 font-bold text-white transition",onClick:()=>{a(s=>(s||o(!1),!s))},children:t?e.jsx(c,{icon:g}):e.jsx(c,{icon:T})}),t&&e.jsx("div",{className:"fixed top-20 right-6 mt-4 flex max-h-96 w-max flex-col items-start space-y-2 rounded-2xl bg-gray-800 p-5 font-bold text-white transition-all duration-500 ease-in-out",children:e.jsxs("form",{className:"filters m-auto flex flex-col items-start space-y-2",onSubmit:s=>{s.preventDefault();const i=new FormData(s.currentTarget),x=new URLSearchParams;i.forEach((d,p)=>{d&&x.set(p,d.toString())}),window.location.href=`${window.location.pathname}?${x.toString()}`},children:[e.jsx("input",{type:"number",name:"per_page",placeholder:"nº de registros",className:"rounded border px-2 py-1 text-sm",min:"1"}),e.jsx("input",{type:"text",name:"first_name",placeholder:"Nombre",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"last_name",placeholder:"Apellido",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"email",name:"email",placeholder:"Correo",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"address",placeholder:"Dirección",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"company_name",placeholder:"Empresa",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"phone",placeholder:"Teléfono",className:"rounded border px-2 py-1 text-sm"}),e.jsx("button",{type:"submit",className:"w-[100%] rounded border px-3 py-1",children:"⌕"}),e.jsx("button",{type:"button",className:"w-[100%] rounded border px-3 py-1",onClick:()=>{window.location.href=window.location.pathname},children:"↻"})]})}),r&&e.jsx("div",{className:"fixed top-20 right-6 mt-4 flex max-h-96 w-max flex-col items-start space-y-2 rounded-2xl bg-gray-800 p-5 font-bold text-white transition-all duration-500 ease-in-out",children:e.jsxs("form",{className:"add-client m-auto flex flex-col items-start space-y-2",onSubmit:async s=>{var d,p,h,n,l,u;s.preventDefault();const i=new FormData(s.currentTarget),x={first_name:((d=i.get("first_name"))==null?void 0:d.toString())||"",last_name:((p=i.get("last_name"))==null?void 0:p.toString())||"",email:((h=i.get("email"))==null?void 0:h.toString())||"",address:((n=i.get("address"))==null?void 0:n.toString())||"",company_name:((l=i.get("company_name"))==null?void 0:l.toString())||"",phone:((u=i.get("phone"))==null?void 0:u.toString())||""};try{await F(x),alert("Cliente creado exitosamente"),o(!1)}catch{alert("Error al crear el cliente")}},children:[e.jsx("input",{type:"text",name:"first_name",placeholder:"Nombre",className:"rounded border px-2 py-1 text-sm",required:!0}),e.jsx("input",{type:"text",name:"last_name",placeholder:"Apellido",className:"rounded border px-2 py-1 text-sm",required:!0}),e.jsx("input",{type:"email",name:"email",placeholder:"Correo",className:"rounded border px-2 py-1 text-sm",required:!0}),e.jsx("input",{type:"text",name:"address",placeholder:"Dirección",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"company_name",placeholder:"Empresa",className:"rounded border px-2 py-1 text-sm"}),e.jsx("input",{type:"text",name:"phone",placeholder:"Teléfono",className:"rounded border px-2 py-1 text-sm"}),e.jsx("button",{type:"submit",className:"w-[100%] rounded border px-3 py-1",children:"Crear Cliente"})]})})]})},L=({currentPage:t,totalPages:a})=>e.jsxs("div",{className:"mt-6 flex justify-center gap-2 flex-wrap ",children:[e.jsx("button",{className:"px-3 py-1 bg-[#8884d8] text-white rounded hover:bg-gray-800 disabled:opacity-50",onClick:()=>{if(t>1){const r=new URLSearchParams(window.location.search);r.set("page",(t-1).toString()),window.location.href=`${window.location.pathname}?${r.toString()}`}},disabled:t===1,children:"Anterior"}),Array.from({length:a},(r,o)=>o+1).map(r=>e.jsx("button",{className:`px-3 py-1 rounded ${r===t?"bg-[#8884d8] text-white border-2 border-[#1f2937]":"bg-[#8884d8] text-white hover:bg-gray-800"}`,onClick:()=>{const o=new URLSearchParams(window.location.search);o.set("page",r.toString()),window.location.href=`${window.location.pathname}?${o.toString()}`},children:r},r)),e.jsx("button",{className:"px-3 py-1 bg-[#8884d8] text-white rounded hover:bg-gray-800 disabled:opacity-50",onClick:()=>{if(t<a){const r=new URLSearchParams(window.location.search);r.set("page",(t+1).toString()),window.location.href=`${window.location.pathname}?${r.toString()}`}},disabled:t===a,children:"Siguiente"})]}),q=({client:t})=>{const a=()=>{const o=document.getElementById("patch-client-modal");o&&(j.createRoot(o).unmount(),document.body.removeChild(o))},r=async o=>{o.preventDefault();const s=new FormData(o.target),i={first_name:s.get("first_name"),last_name:s.get("last_name"),email:s.get("email"),phone:s.get("phone"),address:s.get("address"),company_name:s.get("company_name")};await b.updateClient(t.id,i),a(),window.location.reload()};return e.jsx("div",{id:"patch-client-modal",className:"bg-opacity-50 fixed inset-0 flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"relative rounded bg-white w-[50vh] p-10 shadow-lg",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",onClick:a,children:e.jsx(c,{icon:g})}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Editar Cliente"}),e.jsxs("form",{onSubmit:r,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nombre"}),e.jsx("input",{type:"text",name:"first_name",defaultValue:t.first_name,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Apellido"}),e.jsx("input",{type:"text",name:"last_name",defaultValue:t.last_name,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",defaultValue:t.email,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Teléfono"}),e.jsx("input",{type:"text",name:"phone",defaultValue:t.phone,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Dirección"}),e.jsx("input",{type:"text",name:"address",defaultValue:t.address,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Compañía"}),e.jsx("input",{type:"text",name:"company_name",defaultValue:t.company_name,className:"mt-1 block w-full p-2 border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:a,className:"mr-2 p-2 border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:outline-none",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"p-2 bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:outline-none",children:"Guardar"})]})]})]})})},U=t=>{const a=document.createElement("div");a.id="patch-client-modal",document.body.appendChild(a),j.createRoot(a).render(e.jsx(q,{client:t}))},V=v.lazy(()=>D(()=>import("./error-page-DpAlqp0P.js"),__vite__mapDeps([0,1,2]))),I=t=>{const a=new Date(t);return`${a.getUTCDate().toString().padStart(2,"0")}-${(a.getUTCMonth()+1).toString().padStart(2,"0")}-${a.getUTCFullYear()}`},G=()=>{const[t,a]=m.useState([]),[r,o]=m.useState(!0),[s,i]=m.useState(null),[x,d]=m.useState(1),[p,h]=m.useState(1);return m.useEffect(()=>{(async()=>{o(!0);try{const l=new URLSearchParams(window.location.search),u=l.get("per_page")||"15",y=parseInt(l.get("page")||"1"),w=l.get("first_name")||"",N=l.get("last_name")||"",_=l.get("email")||"",C=l.get("address")||"",S=l.get("company_name")||"",f=await b.getClients({per_page:parseInt(u),page:y,first_name:w,last_name:N,email:_,address:C,company_name:S});if(!f){i("No se pudo obtener la lista de clientes");return}a(f.data),d(f.current_page),h(f.last_page)}catch(l){alert("Error al eliminar cliente"),i(l.message||"Error fetching clients")}finally{o(!1)}})()},[]),s?e.jsx(V,{}):e.jsxs("div",{className:"mx-auto h-[100vh] bg-gray-100 p-6",children:[r&&e.jsx("p",{className:"text-gray-600",children:"Cargando clientes..."}),e.jsxs(k,{href:"/dashboard",className:"font-semibold text-blue-600 hover:underline",children:[e.jsx(c,{icon:$})," Volver a Dashboard"]}),e.jsx(R,{}),e.jsx("h2",{className:"mt-3 text-2xl font-bold text-gray-900",children:"Clientes"}),e.jsxs("div",{className:"mt-2 flex items-center text-red-600",children:[e.jsx(c,{icon:A,className:"mr-2"}),e.jsx("span",{className:"font-semibold",children:"Solo los administradores pueden modificar o eliminar clientes"})]}),e.jsx("div",{className:"mt-3 overflow-x-auto border rounded-[6px] border-gray-200 bg-white",children:e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{className:"border-b bg-[#8884d8] text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-0 py-0 text-left text-[10px] sm:text-sm sm:p-2",children:"Nombre"}),e.jsx("th",{className:"px-0 py-0 text-left text-[10px] sm:text-sm sm:p-2",children:"Email"}),e.jsx("th",{className:"px-0 py-0 text-left text-[10px] sm:text-sm sm:p-2",children:"Teléfono"}),e.jsx("th",{className:"hidden px-0 py-0 text-left text-[10px] sm:table-cell sm:text-sm sm:p-2",children:"Dirección"}),e.jsx("th",{className:"px-0 py-0 text-left text-[10px] sm:text-sm sm:p-2",children:"Compañía"}),e.jsx("th",{className:"hidden px-0 py-0 text-left text-[10px] sm:table-cell sm:text-sm sm:p-2",children:"Creado"}),e.jsx("th",{className:"px-0 py-0 text-left text-[10px] sm:text-sm sm:p-2",children:"Acciones"})]})}),e.jsx("tbody",{children:t.map((n,l)=>e.jsxs("tr",{className:l%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-0 py-0 text-[10px] sm:px-2 sm:py-3 sm:text-xs",children:n.first_name}),e.jsx("td",{className:"px-0 py-0 text-[10px] sm:px-2 sm:py-3 sm:text-xs",children:n.email}),e.jsx("td",{className:"px-0 py-0 text-[10px] sm:px-2 sm:py-3 sm:text-xs",children:n.phone}),e.jsx("td",{className:"hidden px-0 py-0 text-[10px] sm:table-cell sm:px-2 sm:py-3 sm:text-xs",children:n.address}),e.jsx("td",{className:"px-0 py-0 text-[10px] sm:px-2 sm:py-3 sm:text-xs",children:n.company_name}),e.jsx("td",{className:"collapsible hidden px-0 py-0 text-[10px] text-gray-500 sm:table-cell sm:text-xs",children:I(n.created_at)}),e.jsxs("td",{className:"space-x-2 px-0 py-0 text-xs sm:text-sm",children:[e.jsx("button",{className:"text-blue-600 transition hover:scale-110",onClick:()=>U({id:n.id,first_name:n.first_name,last_name:n.last_name||"",email:n.email,phone:n.phone||"",address:n.address||"",company_name:n.company_name||""}),children:"✏️"}),e.jsx("button",{className:"text-red-600 transition hover:scale-110",onClick:async()=>{await b.deleteClient(n.id),E.visit("/clients")},children:"🗑️"})]})]},n.id))})]})}),e.jsx(L,{currentPage:x,totalPages:p})]})};export{G as default};
