import{j as I,R as y,b as u}from"./app-BSMtCD-y.js";import{c as V,S as z,a as L}from"./index-BCEuPExn.js";const x=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,S=V,R=(t,e)=>n=>{var o;if((e==null?void 0:e.variants)==null)return S(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:c}=e,b=Object.keys(a).map(s=>{const i=n==null?void 0:n[s],r=c==null?void 0:c[s];if(i===null)return null;const l=x(i)||x(r);return a[s][l]}),d=n&&Object.entries(n).reduce((s,i)=>{let[r,l]=i;return l===void 0||(s[r]=l),s},{}),g=e==null||(o=e.compoundVariants)===null||o===void 0?void 0:o.reduce((s,i)=>{let{class:r,className:l,...v}=i;return Object.entries(v).every(C=>{let[h,f]=C;return Array.isArray(f)?f.includes({...c,...d}[h]):{...c,...d}[h]===f})?[...s,r,l]:s},[]);return S(t,b,g,n==null?void 0:n.class,n==null?void 0:n.className)},N=R("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40",outline:"border border-input bg-background shadow-xs hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function M({className:t,variant:e,size:n,asChild:o=!1,...a}){const c=o?z:"button";return I.jsx(c,{"data-slot":"button",className:L(N({variant:e,size:n,className:t})),...a})}const k=t=>{let e;const n=new Set,o=(s,i)=>{const r=typeof s=="function"?s(e):s;if(!Object.is(r,e)){const l=e;e=i??(typeof r!="object"||r===null)?r:Object.assign({},e,r),n.forEach(v=>v(e,l))}},a=()=>e,d={setState:o,getState:a,getInitialState:()=>g,subscribe:s=>(n.add(s),()=>n.delete(s))},g=e=t(o,a,d);return d},O=t=>t?k(t):k,A=t=>t;function U(t,e=A){const n=y.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return y.useDebugValue(n),n}const w=t=>{const e=O(t),n=o=>U(e,o);return Object.assign(n,e),n},_=t=>t?w(t):w,m="https://leadtie.onrender.com/api",$=async(t,e)=>{const n=await u.post(`${m}/login`,{email:t,password:e}),{token:o}=n.data;localStorage.setItem("tokenCRM",o),u.defaults.headers.common.Authorization=`Bearer ${o}`},j=async()=>{if(localStorage.getItem("tokenCRM"))try{await u.post(`${m}/logout`)}catch(e){console.error("Error during logout:",e)}localStorage.removeItem("tokenCRM"),delete u.defaults.headers.common.Authorization},p=async()=>{const t=localStorage.getItem("tokenCRM");if(!t)return null;u.defaults.headers.common.Authorization=`Bearer ${t}`;try{return(await u.post(`${m}/getuser`)).data}catch{return j(),null}},D=_(t=>({user:null,isLoading:!0,login:async(e,n)=>{try{const o=await $(e,n),a=await p();t({user:{...a,token:o}})}catch(o){throw console.error("Login error:",o),o}finally{t({isLoading:!1})}},logout:()=>{j(),t({user:null})},fetchUser:async()=>{t({isLoading:!0});try{const e=await p();t({user:e})}catch(e){console.error("Error fetching user:",e),t({user:null})}finally{t({isLoading:!1})}},setUser:e=>t({user:e}),setLoading:e=>t({isLoading:e})}));export{M as B,p as g,j as l,D as u};
